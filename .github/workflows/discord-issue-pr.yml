name: ğŸ“£ ë””ìŠ¤ì½”ë“œ ì•Œë¦¼ë´‡

on:
  issues:
    types: [opened]
  issue_comment:
    types: [created]
  pull_request:
    types: [opened]
  pull_request_review_comment:
    types: [created]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¤ ë””ìŠ¤ì½”ë“œë¡œ ì•Œë¦¼ ë³´ë‚´ê¸°
        run: |
          EVENT_NAME="${{ github.event_name }}"
          REPO="${{ github.repository }}"

          if [[ "$EVENT_NAME" == "issues" ]]; then
            TITLE="${{ github.event.issue.title }}"
            NUMBER="${{ github.event.issue.number }}"
            USER="${{ github.event.issue.user.login }}"
            BODY="${{ github.event.issue.body }}"
            URL="https://github.com/${REPO}/issues/${NUMBER}"
            WEBHOOK="${{ secrets.DISCORD_ISSUE_WEBHOOK_URL }}"

            CONTENT="ğŸ“¢ **[ì´ìŠˆ ìƒì„±]** #${NUMBER} - ${TITLE}\nğŸ§‘ ì‘ì„±ì: @${USER}\nğŸ“ ë§í¬: ${URL}\nğŸ“ ë‚´ìš©: ${BODY}"

          elif [[ "$EVENT_NAME" == "pull_request" ]]; then
            TITLE="${{ github.event.pull_request.title }}"
            NUMBER="${{ github.event.pull_request.number }}"
            USER="${{ github.event.pull_request.user.login }}"
            BODY="${{ github.event.pull_request.body }}"
            URL="https://github.com/${REPO}/pull/${NUMBER}"
            WEBHOOK="${{ secrets.DISCORD_PR_WEBHOOK_URL }}"

            CONTENT="ğŸ“¢ **[PR ìƒì„±]** #${NUMBER} - ${TITLE}\nğŸ§‘ ì‘ì„±ì: @${USER}\nğŸ“ ë§í¬: ${URL}\nğŸ“ ë‚´ìš©: ${BODY}"

          elif [[ "$EVENT_NAME" == "issue_comment" ]]; then
            NUMBER="${{ github.event.issue.number }}"
            USER="${{ github.event.comment.user.login }}"
            COMMENT_BODY="${{ github.event.comment.body }}"
            COMMENT_URL="${{ github.event.comment.html_url }}"
            WEBHOOK="${{ secrets.DISCORD_ISSUE_WEBHOOK_URL }}"

            CONTENT="ğŸ’¬ **[ëŒ“ê¸€ ë“±ë¡]** ${USER} ë‹˜ì´ ì´ìŠˆ #${NUMBER}ì— ëŒ“ê¸€ì„ ë‚¨ê²¼ì–´ìš”!\nğŸ’¬ \"${COMMENT_BODY}\"\nğŸ“ ${COMMENT_URL}"

          elif [[ "$EVENT_NAME" == "pull_request_review_comment" ]]; then
            PR_NUMBER="${{ github.event.pull_request.number }}"
            USER="${{ github.event.comment.user.login }}"
            COMMENT_BODY="${{ github.event.comment.body }}"
            COMMENT_URL="${{ github.event.comment.html_url }}"
            WEBHOOK="${{ secrets.DISCORD_PR_WEBHOOK_URL }}"

            CONTENT="ğŸ’¬ **[PR ëŒ“ê¸€ ë“±ë¡]** ${USER} ë‹˜ì´ PR #${PR_NUMBER}ì— ëŒ“ê¸€ì„ ë‚¨ê²¼ì–´ìš”!\nğŸ’¬ \"${COMMENT_BODY}\"\nğŸ“ ${COMMENT_URL}"
          else
            CONTENT="âš ï¸ ì•Œ ìˆ˜ ì—†ëŠ” ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆì–´ìš”: ${EVENT_NAME}"
            WEBHOOK="${{ secrets.DISCORD_ISSUE_WEBHOOK_URL }}"
          fi

          echo "ğŸ“„ ë©”ì‹œì§€ ë‚´ìš©:"
          echo "$CONTENT"

          curl -H "Content-Type: application/json" \
               -X POST \
               -d @payload.json \
               "$WEBHOOK"
