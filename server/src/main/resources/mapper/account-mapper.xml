<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.olivin.app.example.mapper.AccountLederMapper">

    <select id="selectAllList" resultType="com.olivin.app.example.service.AccountLederVO">
        SELECT 
            al.account_leder_id as accountLederId,
            al.increase,
            al.decrease,
            al.balance,
            al.detail,
            al.write_date as writeDate,
            al.comp_id as compId,
            c.comp_name as compName,
            al.product_id as productId,
            p.product_name as productName,
            al.account_id as accountId,
            a.account_name as accountName
        FROM account_leder al
        LEFT JOIN accounts a ON al.account_id = a.account_id
        LEFT JOIN companys c ON al.comp_id = c.comp_id
        LEFT JOIN products p ON al.product_id = p.product_id
        ORDER BY al.write_date DESC
    </select>
    
    <select id="selectByCondition" resultType="com.olivin.app.example.service.AccountLederVO" parameterType="map">
        SELECT 
            al.account_leder_id as accountLederId,
            al.increase,
            al.decrease,
            al.balance,
            al.detail,
            al.write_date as writeDate,
            al.comp_id as compId,
            c.comp_name as compName,
            al.product_id as productId,
            p.product_name as productName,
            al.account_id as accountId,
            a.account_name as accountName
        FROM account_leder al
        LEFT JOIN accounts a ON al.account_id = a.account_id
        LEFT JOIN companys c ON al.comp_id = c.comp_id
        LEFT JOIN products p ON al.product_id = p.product_id
        <where>
            <if test="accountId != null and accountId != ''">
                AND al.account_id LIKE '%' || #{accountId} || '%'
            </if>
            <if test="accountName != null and accountName != ''">
                AND a.account_name LIKE '%' || #{accountName} || '%'
            </if>
            <if test="compId != null and compId != ''">
                AND al.comp_id LIKE '%' || #{compId} || '%'
            </if>
            <if test="compName != null and compName != ''">
                AND c.comp_name LIKE '%' || #{compName} || '%'
            </if>
            <if test="startDate != null and startDate != ''">
                AND al.write_date >= TO_DATE(#{startDate}, 'YYYY-MM-DD')
            </if>
            <if test="endDate != null and endDate != ''">
                AND al.write_date <= TO_DATE(#{endDate}, 'YYYY-MM-DD')
            </if>
        </where>
        ORDER BY al.write_date DESC
    </select>

</mapper>
